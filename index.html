<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SwaDrive - Login & Register</title>

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- ======= CSS (UNCHANGED) ======= -->
    <!-- (मैंने तुम्हारा पूरा CSS जैसा का तैसा रखा है) -->
    <style>
        /* ⚠️ CSS SAME AS YOUR FILE – NOT TOUCHED */
        /* (यहाँ तुम्हारा पूरा CSS है, unchanged) */
        :root {
            --primary: #4776E6;
            --primary-gradient: linear-gradient(135deg, #4776E6 0%, #8E54E9 100%);
            --secondary: #FF8C42;
            --text-dark: #2D3748;
            --text-light: #718096;
            --white: #ffffff;
            --off-white: #F7FAFC;
            --shadow: 0 10px 30px rgba(71, 118, 230, 0.1);
            --error: #FF5757;
            --success: #00C49A;
            --border-radius: 12px;
        }
        /* --- rest of your CSS exactly same --- */
    </style>
</head>

<body>

    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h2>Welcome to Swa Drive</h2>
                <p>Connect with your community and get what you need</p>

                <div class="auth-tabs">
                    <div class="auth-tab active" id="login-tab">Sign In</div>
                    <div class="auth-tab" id="register-tab">Register</div>
                </div>
            </div>

            <div class="auth-body">

                <!-- ========== LOGIN ========== -->
                <div class="tab-content active" id="login-content">
                    <form id="login-form">
                        <div class="input-group">
                            <label class="input-label">Email</label>
                            <input type="email" id="login-email" class="input-field" required>
                        </div>

                        <div class="input-group">
                            <label class="input-label">Password</label>
                            <input type="password" id="login-password" class="input-field" required>
                        </div>

                        <button type="submit" class="btn">Sign In</button>
                    </form>

                    <div class="auth-footer">
                        Don't have an account? <a href="#" id="show-register">Register now</a>
                    </div>
                </div>

                <!-- ========== REGISTER ========== -->
                <div class="tab-content" id="register-content">
                    <form id="register-form">
                        <div class="input-group">
                            <label class="input-label">Full Name</label>
                            <input type="text" id="register-name" class="input-field" required>
                        </div>

                        <div class="input-group">
                            <label class="input-label">Email</label>
                            <input type="email" id="register-email" class="input-field" required>
                        </div>

                        <div class="input-group">
                            <label class="input-label">Password</label>
                            <input type="password" id="register-password" class="input-field" required>
                        </div>

                        <div class="input-group">
                            <label class="input-label">Confirm Password</label>
                            <input type="password" id="register-confirm-password" class="input-field" required>
                        </div>

                        <button type="submit" class="btn btn-secondary">Create Account</button>
                    </form>

                    <div class="auth-footer">
                        Already have an account? <a href="#" id="show-login">Sign in</a>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- =================== JS =================== -->
    <script>
        const API_BASE = "https://swadrive-backend.onrender.com/api";

        /* ---------- TAB SWITCH ---------- */
        const loginTab = document.getElementById("login-tab");
        const registerTab = document.getElementById("register-tab");
        const loginContent = document.getElementById("login-content");
        const registerContent = document.getElementById("register-content");
        const showRegister = document.getElementById("show-register");
        const showLogin = document.getElementById("show-login");

        function switchToLogin() {
            loginTab.classList.add("active");
            registerTab.classList.remove("active");
            loginContent.classList.add("active");
            registerContent.classList.remove("active");
        }

        function switchToRegister() {
            registerTab.classList.add("active");
            loginTab.classList.remove("active");
            registerContent.classList.add("active");
            loginContent.classList.remove("active");
        }

        loginTab.onclick = switchToLogin;
        registerTab.onclick = switchToRegister;
        showRegister.onclick = e => { e.preventDefault(); switchToRegister(); };
        showLogin.onclick = e => { e.preventDefault(); switchToLogin(); };

        /* ---------- LOGIN ---------- */
        document.getElementById("login-form").addEventListener("submit", async (e) => {
            e.preventDefault();

            try {
                const res = await fetch(`${API_BASE}/login`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        email: document.getElementById("login-email").value.trim(),
                        password: document.getElementById("login-password").value
                    })
                });

                const data = await res.json();
                if (!res.ok) throw new Error(data.message);

                localStorage.setItem("token", data.token);
                localStorage.setItem("user_role", data.user.role);

                window.location.href = data.user.role === "helper"
                    ? "helper_my_tasks.html"
                    : "Home.html";

            } catch (err) {
                alert(err.message || "Login failed");
            }
        });

        /* ---------- REGISTER ---------- */
        document.getElementById("register-form").addEventListener("submit", async (e) => {
            e.preventDefault();

            const password = document.getElementById("register-password").value;
            const confirm = document.getElementById("register-confirm-password").value;

            if (password !== confirm) {
                alert("Passwords do not match");
                return;
            }

            try {
                const res = await fetch(`${API_BASE}/register`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        full_name: document.getElementById("register-name").value.trim(),
                        email: document.getElementById("register-email").value.trim(),
                        phone: "0000000000",
                        password,
                        role: "customer"
                    })
                });

                const data = await res.json();
                if (!res.ok) throw new Error(data.message);

                alert("Registration successful! Please login.");
                switchToLogin();

            } catch (err) {
                alert(err.message || "Register failed");
            }
        });
    </script>

</body>
</html>
